FROM ansibleplaybookbundle/apb-base:canary
# MAINTAINER {{ $MAINTAINER }}

LABEL "com.redhat.apb.spec"=\
"IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMj\
IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyBEZXBlbmRlbmNpZXMKIyMjIyMjIyMjIyMjIyMjIyMj\
IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMj\
IyMjIyMKX2Q6ICZfZAogIC0gJ3JlZ2lzdHJ5LmFjY2Vzcy5yZWRoYXQuY29tL3Joc2NsL3Bvc3Rn\
cmVzcWwtOTQtcmhlbDcnCiAgLSAncmVnaXN0cnkuYWNjZXNzLnJlZGhhdC5jb20vcmhzY2wvcG9z\
dGdyZXNxbC05NS1yaGVsNycKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMj\
IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyBTaGFyZWQgUGFyYW1l\
dGVycwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMj\
IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwpfcDogJl9wCiAgLSBuYW1lOiBwb3N0Z3Jlc3Fs\
X2RhdGFiYXNlCiAgICBkZWZhdWx0OiBhZG1pbgogICAgdHlwZTogc3RyaW5nCiAgICB0aXRsZTog\
UG9zdGdyZVNRTCBEYXRhYmFzZSBOYW1lCiAgICByZXF1aXJlZDogdHJ1ZQogIC0gbmFtZTogcG9z\
dGdyZXNxbF91c2VyCiAgICBkZWZhdWx0OiBhZG1pbgogICAgdGl0bGU6IFBvc3RncmVTUUwgVXNl\
cgogICAgdHlwZTogc3RyaW5nCiAgICBtYXhsZW5ndGg6IDYzCiAgICByZXF1aXJlZDogdHJ1ZQog\
IC0gbmFtZTogcG9zdGdyZXNxbF9wYXNzd29yZAogICAgdHlwZTogc3RyaW5nCiAgICBkZXNjcmlw\
dGlvbjogQSByYW5kb20gYWxwaGFudW1lcmljIHN0cmluZyBpZiBsZWZ0IGJsYW5rCiAgICB0aXRs\
ZTogUG9zdGdyZVNRTCBQYXNzd29yZAogICAgZGlzcGxheV90eXBlOiBwYXNzd29yZAogIC0gbmFt\
ZTogaW1hZ2UKICAgIGRlZmF1bHQ6ICdyZWdpc3RyeS5hY2Nlc3MucmVkaGF0LmNvbS9yaHNjbC9w\
b3N0Z3Jlc3FsLTk1LXJoZWw3JwogICAgZW51bTogKl9kCiAgICB0eXBlOiBlbnVtCiAgICB0aXRs\
ZTogUG9zdGdyZVNRTCBWZXJzaW9uCiAgICByZXF1aXJlZDogdHJ1ZQogICAgdXBkYXRhYmxlOiB0\
cnVlCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMj\
IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCnZlcnNpb246IDEuMApuYW1lOiBwb3N0Z3Jlc3Fs\
LWFwYgpkZXNjcmlwdGlvbjogU0NMIFBvc3RncmVTUUwgYXBiIGltcGxlbWVudGF0aW9uCmJpbmRh\
YmxlOiB0cnVlCmFzeW5jOiBvcHRpb25hbAp0YWdzOgogIC0gZGF0YWJhc2VzCiAgLSBwb3N0Z3Jl\
c3FsCm1ldGFkYXRhOgogIGRvY3VtZW50YXRpb25Vcmw6IGh0dHBzOi8vd3d3LnBvc3RncmVzcWwu\
b3JnL2RvY3MvCiAgbG9uZ0Rlc2NyaXB0aW9uOiBBbiBhcGIgdGhhdCBkZXBsb3lzIHBvc3RncmVz\
cWwgOS40IG9yIDkuNS4KICBkZXBlbmRlbmNpZXM6ICpfZAogIGRpc3BsYXlOYW1lOiBQb3N0Z3Jl\
U1FMIChBUEIpCiAgY29uc29sZS5vcGVuc2hpZnQuaW8vaWNvbkNsYXNzOiBpY29uLXBvc3RncmVz\
cWwKICBwcm92aWRlckRpc3BsYXlOYW1lOiAiUmVkIEhhdCwgSW5jLiIKcGxhbnM6CiAgLSBuYW1l\
OiBkZXYKICAgIGRlc2NyaXB0aW9uOiBBIHNpbmdsZSBEQiBzZXJ2ZXIgd2l0aCBubyBzdG9yYWdl\
CiAgICBmcmVlOiB0cnVlCiAgICBtZXRhZGF0YToKICAgICAgZGlzcGxheU5hbWU6IERldmVsb3Bt\
ZW50CiAgICAgIGxvbmdEZXNjcmlwdGlvbjogVGhpcyBwbGFuIHByb3ZpZGVzIGEgc2luZ2xlIG5v\
bi1IQSBQb3N0Z3JlU1FMIHNlcnZlciB3aXRob3V0IHBlcnNpc3RlbnQgc3RvcmFnZQogICAgICBj\
b3N0OiAkMC4wMAogICAgcGFyYW1ldGVyczogKl9wCiAgICB1cGRhdGVzX3RvOgogICAgICAtIHBy\
b2QKICAtIG5hbWU6IHByb2QKICAgIGRlc2NyaXB0aW9uOiBBIHNpbmdsZSBEQiBzZXJ2ZXIgd2l0\
aCBwZXJzaXN0ZW50IHN0b3JhZ2UKICAgIGZyZWU6IHRydWUKICAgIG1ldGFkYXRhOgogICAgICBk\
aXNwbGF5TmFtZTogUHJvZHVjdGlvbgogICAgICBsb25nRGVzY3JpcHRpb246IFRoaXMgcGxhbiBw\
cm92aWRlcyBhIHNpbmdsZSBub24tSEEgUG9zdGdyZVNRTCBzZXJ2ZXIgd2l0aCBwZXJzaXN0ZW50\
IHN0b3JhZ2UKICAgICAgY29zdDogJDAuMDAKICAgIHBhcmFtZXRlcnM6ICpfcAo="

COPY roles /opt/ansible/roles
COPY playbooks/* /opt/apb/actions/
RUN chmod -R g=u /opt/{ansible,apb}

USER apb
